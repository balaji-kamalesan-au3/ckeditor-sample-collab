/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x26e6=['some','discardAllSuggestions','has','head','trackChanges','unbind','from','separator','button','isEnabled','_handleSuggestionControllerDelayed','define','innerView','Accept\x20all\x20suggestions','reduce','init','discardSuggestion','editor','clear','Track\x20changes','config','CommentsRepository','_handleControllerBuffer','getDescriptions','_suggestionToController','commandName','length','trackChanges.disableComments','mapper','_destroyController','delete','execute','_createUIButton','PENDING_ACTION_SUGGESTION','source','getAllAdjacentSuggestions','EditorAnnotations','discardButton','TrackChangesUI','_initializeController','toMany','get','componentFactory','isDirty','comments','refreshSelectedViews','SuggestionThreadView','focus','getContainedElement','getRange','arrowView','add','set','activeMarkers','Discard\x20all\x20selected\x20suggestions','requires','actionView','getJoined','TrackChangesEditing','view','model','_disableComments','change:isDirty','previous','getByInnerView','createAnnotationView','acceptAllSuggestions','commands','suggestion-','remove','suggestionUnloaded','_viewToController','buttonView','locale','comments.maxCommentsWhenCollapsed','hasSuggestion','switchbutton','suggestionChanged','isOn','destroy','Accept\x20all\x20selected\x20suggestions','change:previous','type','comments.maxThreadTotalWeight','listenTo','stopListening','suggestionLoaded','commentThread','comments.editorConfig','CommentsUI','PendingActions','trackChanges.SuggestionThreadView','acceptSelectedSuggestions','editing','Annotations','createAnnotation','getFirstMarker','toViewElement','Discard\x20all\x20suggestions','push','bind','addSourceCollector','pluginName','map','getMarkerNames','plugins','addComment','filter','size','_updateController','isInContent'];(function(_0x44658a,_0x26e692){const _0xf4a0e=function(_0x18403f){while(--_0x18403f){_0x44658a['push'](_0x44658a['shift']());}};_0xf4a0e(++_0x26e692);}(_0x26e6,0x183));const _0xf4a0=function(_0x44658a,_0x26e692){_0x44658a=_0x44658a-0x0;let _0xf4a0e=_0x26e6[_0x44658a];return _0xf4a0e;};import{Plugin as _0x614bca}from'ckeditor5/src/core';import{Collection as _0x8275fd}from'ckeditor5/src/utils';import{Model as _0xe41dd1,SplitButtonView as _0x4af1ae,createDropdown as _0x53e5ac,addListToDropdown as _0x3daa0e}from'ckeditor5/src/ui';import{Users as _0x3a1f36,getDateTimeFormatter as _0x352671,getMarkerDomElement as _0x59d6ac}from'ckeditor5-collaboration/src/collaboration-core';import _0x2f0e29 from'./trackchangesediting';import _0x11997c from'./ui/suggestioncontroller';import _0x518ae2 from'./ui/view/suggestionthreadview';import{getTranslation as _0x558900}from'./utils/common-translations';import _0x4c66d0 from'../theme/icons/track-changes.svg';export default class m extends _0x614bca{static get[_0xf4a0('0x1')](){return[_0x2f0e29,_0x3a1f36,'CommentsRepository','Annotations',_0xf4a0('0x5d')];}static get[_0xf4a0('0x30')](){return _0xf4a0('0x5f');}constructor(_0x36f9e0){super(_0x36f9e0),this[_0xf4a0('0x51')]=new Map(),this[_0xf4a0('0x11')]=new Map(),this['_handleControllerBuffer']=new Map();const _0x123a58=this[_0xf4a0('0x4a')][_0xf4a0('0x4d')];_0x123a58[_0xf4a0('0x44')](_0xf4a0('0x25'),_0x518ae2),_0x123a58[_0xf4a0('0x44')](_0xf4a0('0x54'),!0x1),this[_0xf4a0('0x7')]=_0x123a58[_0xf4a0('0x62')](_0xf4a0('0x54'));}[_0xf4a0('0x43')](_0x279e2d,_0x34de2e){0x0===this['_handleControllerBuffer'][_0xf4a0('0x36')]&&setTimeout(()=>{for(const [_0x5be56d,_0x349c03]of this[_0xf4a0('0x4f')]){const _0x15288d=this[_0xf4a0('0x51')][_0xf4a0('0x3b')](_0x5be56d);_0x15288d||_0x349c03?_0x15288d&&_0x349c03&&this[_0xf4a0('0x56')](_0x5be56d):this['_initializeController'](_0x5be56d);}this[_0xf4a0('0x4a')][_0xf4a0('0x33')]['get'](_0xf4a0('0x5d'))[_0xf4a0('0x66')](),this[_0xf4a0('0x4f')][_0xf4a0('0x4b')]();},0xa),this['_handleControllerBuffer'][_0xf4a0('0x6d')](_0x279e2d,_0x34de2e);}[_0xf4a0('0x48')](){const _0x5926d4=this[_0xf4a0('0x4a')],_0x10c862=_0x5926d4['plugins'][_0xf4a0('0x62')](_0x2f0e29),_0x20a6fe=_0x5926d4[_0xf4a0('0x33')]['get'](_0xf4a0('0x28')),_0x7afa75=_0x5926d4[_0xf4a0('0x33')]['get'](_0xf4a0('0x5d')),_0x4cbd83=_0x5926d4[_0xf4a0('0x33')]['get'](_0xf4a0('0x4e'));_0x5926d4['ui'][_0xf4a0('0x63')][_0xf4a0('0x6c')](_0xf4a0('0x3d'),_0x205193=>this['_createUIButton'](_0x205193)),_0x7afa75[_0xf4a0('0x2f')](()=>{const _0x41de66=[];for(const [_0x28b1d1,_0x48b31c]of Array[_0xf4a0('0x3f')](this[_0xf4a0('0x51')])){const _0x78ead2=_0x28b1d1['getAllAdjacentSuggestions'](),_0xd1ad7f=[];for(const _0x1c26ee of _0x78ead2){if(!_0x1c26ee[_0xf4a0('0x38')])continue;if(_0x1c26ee['isMultiRange']){_0xd1ad7f['push'](..._0x1c26ee['getRanges']());continue;}const _0x9d2bd8=_0x1c26ee['getFirstRange']();if(_0xd1ad7f[_0xf4a0('0x53')]>0x0){const _0x327846=_0xd1ad7f[0x0][_0xf4a0('0x3')](_0x9d2bd8);if(_0x327846){_0xd1ad7f[0x0]=_0x327846;continue;}}_0xd1ad7f['push'](_0x9d2bd8);}_0x41de66[_0xf4a0('0x2d')]([_0x48b31c['view'],_0xd1ad7f]);}return _0x41de66;}),this[_0xf4a0('0x1e')](_0x10c862,_0xf4a0('0x20'),(_0x4dcf20,_0x36081d)=>{this['listenTo'](_0x36081d,'change:previous',(_0xdab03f,_0x2257be,_0x46f89d,_0x4bf3bf)=>{_0x36081d['isInContent']&&(null==_0x46f89d?(this[_0xf4a0('0x37')](_0x4bf3bf[_0xf4a0('0x3c')]),this[_0xf4a0('0x43')](_0x36081d,!0x1)):(this[_0xf4a0('0x37')](_0x46f89d[_0xf4a0('0x3c')]),this[_0xf4a0('0x43')](_0x36081d,!0x0)));}),null===_0x36081d[_0xf4a0('0x9')]?this[_0xf4a0('0x43')](_0x36081d,!0x1):this[_0xf4a0('0x37')](_0x36081d[_0xf4a0('0x3c')]);}),this[_0xf4a0('0x1e')](_0x10c862,_0xf4a0('0x10'),(_0x4532cb,_0x429e95,_0x1ae809)=>{this[_0xf4a0('0x1f')](_0x429e95,_0xf4a0('0x1b')),this[_0xf4a0('0x4f')][_0xf4a0('0x57')](_0x429e95);const _0x307036=_0x1ae809?_0x1ae809[_0xf4a0('0x3c')]:_0x429e95,_0x564dc8=this['_suggestionToController']['get'](_0x307036);null!==_0x1ae809&&this[_0xf4a0('0x37')](_0x307036),null===_0x1ae809&&_0x564dc8&&this[_0xf4a0('0x56')](_0x429e95);}),this[_0xf4a0('0x1e')](_0x10c862,_0xf4a0('0x17'),(_0x40fe33,_0x29181c)=>{this[_0xf4a0('0x37')](_0x29181c);}),this['listenTo'](_0x20a6fe,'change:activeAnnotations',(_0x3b0fc1,_0x36297c,_0x444c89)=>{const _0x4d687e=Array[_0xf4a0('0x3f')](_0x444c89,_0x4a8a45=>_0x4a8a45[_0xf4a0('0x45')])[_0xf4a0('0x35')](_0x564124=>this['_viewToController'][_0xf4a0('0x3b')](_0x564124)),_0x9700e5=[];for(const _0x26cabb of _0x4d687e){const _0x49f20e=this[_0xf4a0('0x11')][_0xf4a0('0x62')](_0x26cabb)['model'][_0xf4a0('0x5c')]();_0x9700e5[_0xf4a0('0x2d')](..._0x49f20e[_0xf4a0('0x47')]((_0x1296d4,_0x5b1718)=>[..._0x1296d4,..._0x5b1718[_0xf4a0('0x32')]()],[]));}_0x10c862[_0xf4a0('0x6e')]=_0x9700e5;}),this[_0xf4a0('0x1e')](_0x4cbd83,_0xf4a0('0x34'),(_0x515cc3,{threadId:_0x27ff50,isFromAdapter:_0x22755a})=>{if(_0x22755a||!_0x10c862[_0xf4a0('0x15')](_0x27ff50))return;const _0x4fdd99=_0x10c862['getSuggestion'](_0x27ff50);this['_suggestionToController']['get'](_0x4fdd99)[_0xf4a0('0x5')][_0xf4a0('0x68')]();},{'priority':'lowest'});}[_0xf4a0('0x59')](_0x554051){const _0x3a6bd2=_0x53e5ac(_0x554051,_0x4af1ae),_0x16a8d9=this[_0xf4a0('0x4a')]['commands'][_0xf4a0('0x62')](_0xf4a0('0x3d')),_0xa57093=_0x558900(_0x554051,_0xf4a0('0x4c'));_0x3a6bd2[_0xf4a0('0x12')][_0xf4a0('0x6d')]({'tooltip':_0xa57093,'label':_0xa57093,'icon':_0x4c66d0}),_0x3a6bd2['buttonView'][_0xf4a0('0x2e')]('isOn')['to'](_0x16a8d9,'value'),_0x3a6bd2[_0xf4a0('0x12')]['on'](_0xf4a0('0x58'),()=>{_0x16a8d9[_0xf4a0('0x58')](),this[_0xf4a0('0x4a')][_0xf4a0('0x27')]['view']['focus']();});const _0x5d8e48=new _0x8275fd(),_0x4224f4=[{'type':_0xf4a0('0x16'),'model':{'withText':!0x0,'label':_0xa57093,'commandName':_0xf4a0('0x3d')}},{'type':_0xf4a0('0x40')},{'type':_0xf4a0('0x41'),'model':{'withText':!0x0,'label':_0x558900(_0x554051,_0xf4a0('0x46')),'commandName':_0xf4a0('0xc')}},{'type':_0xf4a0('0x41'),'model':{'withText':!0x0,'label':_0x558900(_0x554051,_0xf4a0('0x1a')),'commandName':_0xf4a0('0x26')}},{'type':_0xf4a0('0x41'),'model':{'withText':!0x0,'label':_0x558900(_0x554051,_0xf4a0('0x2c')),'commandName':_0xf4a0('0x3a')}},{'type':_0xf4a0('0x41'),'model':{'withText':!0x0,'label':_0x558900(_0x554051,_0xf4a0('0x0')),'commandName':'discardSelectedSuggestions'}}];for(const _0x4852ec of _0x4224f4){const _0x309da6={'type':_0x4852ec[_0xf4a0('0x1c')]};if(_0x4852ec['model']){const _0x23ea47=new _0xe41dd1(_0x4852ec[_0xf4a0('0x6')]),_0x235396=this[_0xf4a0('0x4a')][_0xf4a0('0xd')][_0xf4a0('0x62')](_0x23ea47[_0xf4a0('0x52')]);_0x23ea47[_0xf4a0('0x2e')](_0xf4a0('0x18'),'isEnabled')['to'](_0x235396,'value',_0xf4a0('0x42')),_0x309da6['model']=_0x23ea47;}_0x5d8e48[_0xf4a0('0x6c')](_0x309da6);}_0x3daa0e(_0x3a6bd2,_0x5d8e48);const _0x294151=_0x4224f4[_0xf4a0('0x35')](_0x2dccc9=>null!=_0x2dccc9[_0xf4a0('0x6')])[_0xf4a0('0x31')](_0x546907=>this[_0xf4a0('0x4a')][_0xf4a0('0xd')]['get'](_0x546907[_0xf4a0('0x6')]['commandName']));return _0x3a6bd2[_0xf4a0('0x12')][_0xf4a0('0x2')][_0xf4a0('0x3e')](_0xf4a0('0x42')),_0x3a6bd2['buttonView'][_0xf4a0('0x6b')][_0xf4a0('0x3e')](_0xf4a0('0x42')),_0x3a6bd2[_0xf4a0('0x12')][_0xf4a0('0x2')][_0xf4a0('0x2e')](_0xf4a0('0x42'))['to'](_0x16a8d9,_0xf4a0('0x42')),_0x3a6bd2[_0xf4a0('0x12')][_0xf4a0('0x6b')][_0xf4a0('0x2e')](_0xf4a0('0x42'))[_0xf4a0('0x61')](_0x294151,'isEnabled',(..._0x1d5782)=>_0x1d5782[_0xf4a0('0x39')](_0x3e9d95=>_0x3e9d95)),_0x3a6bd2['on'](_0xf4a0('0x58'),_0xc4655c=>{this[_0xf4a0('0x4a')]['execute'](_0xc4655c[_0xf4a0('0x5b')][_0xf4a0('0x52')]),this[_0xf4a0('0x4a')][_0xf4a0('0x27')][_0xf4a0('0x5')][_0xf4a0('0x68')]();}),_0x3a6bd2;}[_0xf4a0('0x60')](_0x10aff8){const _0x38f300=this[_0xf4a0('0x4a')],_0x2a471c=_0x38f300[_0xf4a0('0x4d')],_0x42b7a5=_0x38f300[_0xf4a0('0x33')][_0xf4a0('0x62')]('Annotations'),_0x32d81c=_0x38f300[_0xf4a0('0x33')]['get'](_0xf4a0('0x4e')),_0x2209b5=_0x38f300[_0xf4a0('0x33')][_0xf4a0('0x62')](_0xf4a0('0x5d')),_0x479108=_0x10aff8['getAllAdjacentSuggestions']()[_0xf4a0('0x35')](_0x527882=>_0x527882[_0xf4a0('0x38')]),_0x3a91fc=_0x38f300['plugins']['get'](_0x3a1f36)['me'],_0x3995c4=_0x38f300['commands']['get']('acceptSuggestion'),_0x5606b6=_0x38f300[_0xf4a0('0xd')]['get'](_0xf4a0('0x49')),_0x463cd3=_0x2a471c['get'](_0xf4a0('0x3d'))[_0xf4a0('0x67')],{CommentsListView:_0x45b8ba,CommentThreadInputView:_0x2290e6}=_0x38f300[_0xf4a0('0x33')]['get'](_0xf4a0('0x23')),_0x20e127=new _0x463cd3(_0x38f300[_0xf4a0('0x13')],_0x10aff8,_0x3a91fc,{'disableComments':this['_disableComments'],'editorConfig':_0x2a471c[_0xf4a0('0x62')](_0xf4a0('0x22')),'maxCommentsWhenCollapsed':_0x2a471c[_0xf4a0('0x62')](_0xf4a0('0x14')),'maxThreadTotalWeight':_0x2a471c['get'](_0xf4a0('0x1d')),'maxCommentCharsWhenCollapsed':_0x2a471c[_0xf4a0('0x62')]('comments.maxCommentCharsWhenCollapsed'),'formatDateTime':_0x352671(_0x2a471c[_0xf4a0('0x62')](_0xf4a0('0x13'))),'CommentView':_0x2a471c['get'](_0xf4a0('0x65'))['CommentView'],'CommentsListView':_0x45b8ba,'CommentThreadInputView':_0x2290e6}),_0x1e1fb9=_0x32d81c['createCommentThreadController'](_0x10aff8[_0xf4a0('0x21')],_0x20e127),_0x1213e2=new _0x11997c(_0x10aff8,_0x20e127,_0x3995c4,_0x5606b6,_0x1e1fb9);_0x20e127['descriptionParts']=_0x38f300[_0xf4a0('0x33')]['get']('TrackChangesEditing')['_descriptionFactory'][_0xf4a0('0x50')](_0x479108),this[_0xf4a0('0x51')][_0xf4a0('0x6d')](_0x10aff8,_0x1213e2),this['_viewToController'][_0xf4a0('0x6d')](_0x20e127,_0x1213e2);const _0x4d5a55=_0x42b7a5[_0xf4a0('0xb')](this[_0xf4a0('0x4a')]['locale'],_0x20e127);_0x4d5a55[_0xf4a0('0x2e')](_0xf4a0('0x64'))['to'](_0x20e127,_0xf4a0('0x64')),_0x4d5a55[_0xf4a0('0x2e')](_0xf4a0('0x53'))['to'](_0x20e127),_0x4d5a55[_0xf4a0('0x2e')]('type')['to'](_0x20e127,_0xf4a0('0x1c'),_0x969856=>'suggestion-'+_0x969856);const _0x59afe6=_0x42b7a5[_0xf4a0('0x29')]({'view':_0x4d5a55,'target':()=>{const _0x5353aa=_0x479108[0x0][_0xf4a0('0x2a')]();if(!_0x5353aa)return null;const _0x1d39d1=_0x5353aa[_0xf4a0('0x6a')]()[_0xf4a0('0x69')]();return _0x1d39d1&&!_0x38f300[_0xf4a0('0x27')][_0xf4a0('0x55')][_0xf4a0('0x2b')](_0x1d39d1)?null:_0x59d6ac(_0x38f300[_0xf4a0('0x27')],_0x5353aa)||null;},'type':()=>_0xf4a0('0xe')+_0x1213e2[_0xf4a0('0x5')][_0xf4a0('0x1c')]});_0x42b7a5[_0xf4a0('0x6c')](_0x59afe6),_0x2209b5['registerAnnotation'](_0x59afe6);const _0x5ecde7=_0x38f300[_0xf4a0('0x33')]['get'](_0xf4a0('0x24'));let _0x9de82;_0x20e127['on'](_0xf4a0('0x8'),(_0x1eb8de,_0x404b54,_0x431528)=>{_0x431528?_0x9de82=_0x5ecde7[_0xf4a0('0x6c')](_0x558900(this[_0xf4a0('0x4a')][_0xf4a0('0x13')],_0xf4a0('0x5a'))):(_0x5ecde7[_0xf4a0('0xf')](_0x9de82),_0x9de82=null);}),_0x20e127['acceptButton']['on']('execute',()=>{_0x38f300[_0xf4a0('0x27')][_0xf4a0('0x5')][_0xf4a0('0x68')]();}),_0x20e127[_0xf4a0('0x5e')]['on'](_0xf4a0('0x58'),()=>{_0x38f300[_0xf4a0('0x27')][_0xf4a0('0x5')][_0xf4a0('0x68')]();});}['_destroyController'](_0xa588c9){const _0x1b4dba=this[_0xf4a0('0x4a')][_0xf4a0('0x33')][_0xf4a0('0x62')](_0xf4a0('0x28')),_0x1f124a=this[_0xf4a0('0x51')][_0xf4a0('0x62')](_0xa588c9),_0xb2222e=_0x1f124a[_0xf4a0('0x5')],_0x40e690=_0x1b4dba[_0xf4a0('0xa')](_0xb2222e);_0x40e690&&_0x1b4dba[_0xf4a0('0xf')](_0x40e690),this[_0xf4a0('0x51')][_0xf4a0('0x57')](_0xa588c9),this[_0xf4a0('0x11')][_0xf4a0('0x57')](_0xb2222e),_0x1f124a['destroy'](),_0xb2222e[_0xf4a0('0x19')]();}[_0xf4a0('0x37')](_0x11c650){if(!_0x11c650[_0xf4a0('0x38')]||!this[_0xf4a0('0x51')][_0xf4a0('0x3b')](_0x11c650))return;const _0x1c0132=this[_0xf4a0('0x4a')][_0xf4a0('0x33')]['get'](_0xf4a0('0x4')),_0x5c7b06=this[_0xf4a0('0x51')][_0xf4a0('0x62')](_0x11c650),_0x43c5b8=_0x11c650[_0xf4a0('0x5c')]();_0x5c7b06['view']['descriptionParts']=_0x1c0132['_descriptionFactory'][_0xf4a0('0x50')](_0x43c5b8);}[_0xf4a0('0x19')](){super[_0xf4a0('0x19')]();for(const _0x21bfeb of this['_suggestionToController']['keys']())this[_0xf4a0('0x56')](_0x21bfeb);}}