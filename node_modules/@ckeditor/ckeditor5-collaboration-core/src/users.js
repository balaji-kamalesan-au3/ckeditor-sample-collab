/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x7336=['initials','ck-user__selection--','licenseKeyTrialLimit:operations','defineMe','ck-user__bg-color--','length','licenseKeyTrial','trial-license-key-reached-limit-revisions','_isAnonymous','users','_id','_locale','decorate','licenseKeyValid','define','config','You\x20are\x20using\x20the\x20trial\x20version\x20of\x20CKEditor\x205\x20collaboration\x20plugin\x20with\x20limited\x20usage.\x20Make\x20sure\x20you\x20will\x20not\x20use\x20it\x20in\x20the\x20production\x20environment.','licenseKeyTrialLimit:time','licenseKeyInvalid','init','anonymous-user','toUpperCase','_getInitial','_getNextColor','users-me-already-defined','users-me-missing-user','name','color','_lastColor','getMarkerClass','_myId','users.anonymousUserId','addUser','destroy','_addAnonymousUser','getSelectionClass','Anonymous','assign','trim','charAt','getOperationAuthor','requires','context','avatar','licenseKeyTrialLimit:revisions','getBackgroundColorClass','isAnonymous','licenseKey','useAnonymousUser','users.colorsCount','get','locale','_licenseKeyCheckInterval','has','getUser','users-add-invalid-id','trial-license-key-reached-limit-time'];(function(_0x56dc43,_0x7336c5){const _0x400a4a=function(_0x5ee307){while(--_0x5ee307){_0x56dc43['push'](_0x56dc43['shift']());}};_0x400a4a(++_0x7336c5);}(_0x7336,0x1d1));const _0x400a=function(_0x56dc43,_0x7336c5){_0x56dc43=_0x56dc43-0x0;let _0x400a4a=_0x7336[_0x56dc43];return _0x400a4a;};import{ContextPlugin as _0x42c108}from'ckeditor5/src/core';import{Collection as _0x533d15,CKEditorError as _0x270292}from'ckeditor5/src/utils';import _0x3af45d from'./permissions';import{getTranslation as _0x2e3cb2}from'./utils/common-translations';import'../theme/usercolors.css';export default class l extends _0x42c108{static get['pluginName'](){return'Users';}static get[_0x400a('0x20')](){return[_0x3af45d];}constructor(_0x20792b){super(_0x20792b),_0x20792b[_0x400a('0x6')][_0x400a('0x5')](_0x400a('0x16'),_0x400a('0xb')),_0x20792b['config'][_0x400a('0x5')]('users.colorsCount',0x8),this[_0x400a('0x0')]=new _0x533d15(),this[_0x400a('0x2')]=_0x20792b[_0x400a('0x2a')],this[_0x400a('0x2b')]=null,this['_lastColor']=0x0,this[_0x400a('0x15')]=null,this[_0x400a('0x3')](_0x400a('0x1f'));}[_0x400a('0xa')](){const _0x263add=this[_0x400a('0x21')];this[_0x400a('0x26')]=_0x263add[_0x400a('0x6')][_0x400a('0x29')](_0x400a('0x26'));const _0x239002=['licenseKeyTrial',_0x400a('0x9'),_0x400a('0x4'),_0x400a('0x32'),'licenseKeyTrialLimit:time',_0x400a('0x23')];this['_licenseKeyCheckInterval']=setInterval(()=>{let _0x2a8568;for(const _0x56385f in _0x263add){const _0x27ceef=_0x263add[_0x56385f];if(_0x239002['includes'](_0x27ceef)){delete _0x263add[_0x56385f],_0x2a8568=_0x27ceef;break;}}if(_0x400a('0x9')===_0x2a8568)throw clearInterval(this[_0x400a('0x2b')]),new _0x270292('invalid-license-key',null);if(_0x400a('0x36')===_0x2a8568&&console['info'](_0x400a('0x7')),_0x400a('0x32')===_0x2a8568)throw clearInterval(this[_0x400a('0x2b')]),new _0x270292('trial-license-key-reached-limit-changes',null);if(_0x400a('0x8')===_0x2a8568)throw clearInterval(this[_0x400a('0x2b')]),new _0x270292(_0x400a('0x2f'),null);if(_0x400a('0x23')===_0x2a8568)throw clearInterval(this[_0x400a('0x2b')]),new _0x270292(_0x400a('0x37'),null);_0x400a('0x4')===_0x2a8568&&clearInterval(this[_0x400a('0x2b')]);},0x3e8),this[_0x400a('0x19')]();}get['me'](){return null==this['_myId']?null:this[_0x400a('0x2d')](this[_0x400a('0x15')]);}[_0x400a('0x17')](_0x5c324e){if(!(_0x5c324e=Object[_0x400a('0x1c')]({},_0x5c324e,{'color':this[_0x400a('0xe')]()}))['id']||'string'!=typeof _0x5c324e['id'])throw new _0x270292(_0x400a('0x2e'));if(this[_0x400a('0x0')][_0x400a('0x2c')](_0x5c324e['id']))throw new _0x270292('users-add-duplicated-id',null,{'id':_0x5c324e['id']});_0x5c324e['name']=function(_0x4218af,_0x1dc64e=''){return''==(_0x1dc64e=_0x1dc64e[_0x400a('0x1d')]())?_0x2e3cb2(_0x4218af,'Anonymous'):_0x1dc64e;}(this[_0x400a('0x2')],_0x5c324e[_0x400a('0x11')]);const _0x32477d=new u(_0x5c324e);return this['users']['add'](_0x32477d),_0x32477d;}['getUser'](_0x188b3b){return this[_0x400a('0x0')][_0x400a('0x29')](_0x188b3b);}[_0x400a('0x27')](){const _0x1c9723=this[_0x400a('0x21')][_0x400a('0x6')][_0x400a('0x29')](_0x400a('0x16'));this[_0x400a('0x15')]||this[_0x400a('0x33')](_0x1c9723);}[_0x400a('0x33')](_0x228a2c){if(this[_0x400a('0x15')])throw new _0x270292(_0x400a('0xf'),null);if(!this[_0x400a('0x2d')](_0x228a2c))throw new _0x270292(_0x400a('0x10'),null);this[_0x400a('0x15')]=_0x228a2c;}[_0x400a('0x1f')](){return this['me'];}['destroy'](){super[_0x400a('0x18')](),clearInterval(this['_licenseKeyCheckInterval']);}[_0x400a('0xe')](){const _0x1670e9=this[_0x400a('0x21')]['config'][_0x400a('0x29')](_0x400a('0x28'));return this[_0x400a('0x13')]>=_0x1670e9&&(this['_lastColor']=0x0),new a(this[_0x400a('0x13')]++);}[_0x400a('0x19')](){const _0x38f631=this[_0x400a('0x21')][_0x400a('0x6')][_0x400a('0x29')](_0x400a('0x16'));this['addUser']({'id':_0x38f631,'name':_0x2e3cb2(this[_0x400a('0x2')],_0x400a('0x1b'))})['_isAnonymous']=!0x0;}}class u{constructor(_0x4bc0e8){this['id']=_0x4bc0e8['id'],this[_0x400a('0x12')]=_0x4bc0e8[_0x400a('0x12')],this['name']=_0x4bc0e8['name'],this['avatar']=_0x4bc0e8[_0x400a('0x22')],this[_0x400a('0x38')]=!0x1;}get[_0x400a('0x25')](){return this[_0x400a('0x38')];}get[_0x400a('0x30')](){const _0x50193e=this['name']['split']('\x20');return 0x1===_0x50193e['length']?this['_getInitial'](_0x50193e[0x0]):this[_0x400a('0xd')](_0x50193e[0x0])+this['_getInitial'](_0x50193e[_0x50193e[_0x400a('0x35')]-0x1]);}[_0x400a('0xd')](_0x1f588d){return _0x1f588d[_0x400a('0x1e')](0x0)[_0x400a('0xc')]();}}class a{constructor(_0x2fab92){this[_0x400a('0x1')]=_0x2fab92;}[_0x400a('0x24')](){return _0x400a('0x34')+this['_id'];}[_0x400a('0x1a')](){return _0x400a('0x31')+this[_0x400a('0x1')];}[_0x400a('0x14')](){return'ck-user__marker--'+this['_id'];}}