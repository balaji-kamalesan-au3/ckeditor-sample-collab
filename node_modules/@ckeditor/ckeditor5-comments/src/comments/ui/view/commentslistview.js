/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2749=['isActive','remove','listenTo','change:hasDirtyComment','editorConfig','_handleNewCommentModel','bind','insert','from','_config','_handleRemoveCommentModel','some','add','refreshVisibleViews','length','comments','updateComment','get','visibleViews','isEditMode','locale','element','equal','render','focus','setTemplate','change:isEditMode','_collapsedCommentsView','hasDirtyComment','destroy','CommentView','delegate','_rearrangeCollapse','weight','viewUid','commentUpdated','collapse','commentViews','removeComment','_model','ck-thread__comments','count','createCollection','expand','_shouldCollapse','_updateHasDirtyComment'];(function(_0xac3c02,_0x274925){const _0x3f2274=function(_0x49342a){while(--_0x49342a){_0xac3c02['push'](_0xac3c02['shift']());}};_0x3f2274(++_0x274925);}(_0x2749,0x91));const _0x3f22=function(_0xac3c02,_0x274925){_0xac3c02=_0xac3c02-0x0;let _0x3f2274=_0x2749[_0xac3c02];return _0x3f2274;};import{View as _0x564172}from'ckeditor5/src/ui';import{diff as _0xa99353,Collection as _0x47e4c9}from'ckeditor5/src/utils';import _0x51807b from'./collapsedcommentsview';export default class ct extends _0x564172{constructor(_0x40d1e6,_0x127c43,_0x373c52){super(_0x40d1e6),this['set'](_0x3f22('0x15'),!0x1),this['set'](_0x3f22('0x7'),_0x127c43[_0x3f22('0x8')]['length']),this['set']('isActive',!0x1),this[_0x3f22('0x20')]=_0x127c43,this['_config']=_0x373c52,this['commentViews']=this[_0x3f22('0x23')](),this['visibleViews']=this[_0x3f22('0x23')](),this['_collapsedCommentsView']=new _0x51807b(_0x40d1e6),this[_0x3f22('0x14')][_0x3f22('0x2d')]('count')['to'](this,_0x3f22('0x7'),_0x42194e=>_0x42194e-this[_0x3f22('0x2')]['maxCommentsWhenCollapsed']);for(const _0xb9b5b2 of _0x127c43[_0x3f22('0x8')])this[_0x3f22('0x2c')](_0xb9b5b2);this[_0x3f22('0x29')](_0x127c43[_0x3f22('0x8')],'add',(_0x74c3f7,_0x4d3c33)=>{this[_0x3f22('0x7')]++,this[_0x3f22('0x2c')](_0x4d3c33),this['refreshVisibleViews']();}),this[_0x3f22('0x29')](_0x127c43[_0x3f22('0x8')],_0x3f22('0x28'),(_0x44c3f3,_0x391866)=>{this[_0x3f22('0x7')]--,this[_0x3f22('0x3')](_0x391866),this[_0x3f22('0x6')]();}),this[_0x3f22('0x29')](_0x127c43,_0x3f22('0x1c'),()=>this[_0x3f22('0x6')]()),this['on']('change:isActive',()=>this[_0x3f22('0x6')]()),this['on'](_0x3f22('0x2a'),()=>this[_0x3f22('0x6')]()),this[_0x3f22('0x12')]({'tag':'ul','attributes':{'class':[_0x3f22('0x21')]},'children':this[_0x3f22('0xb')]});}get[_0x3f22('0x25')](){return this[_0x3f22('0x20')][_0x3f22('0x1a')]>this['_config']['maxThreadTotalWeight']&&!this[_0x3f22('0x27')]&&!this[_0x3f22('0x15')];}[_0x3f22('0x10')](){super[_0x3f22('0x10')](),this[_0x3f22('0x6')]();}['focus'](){this[_0x3f22('0xe')][_0x3f22('0x11')]();}[_0x3f22('0x16')](){this['_collapsedCommentsView']['destroy']();for(const _0x30e8d5 of this[_0x3f22('0x1e')])_0x30e8d5[_0x3f22('0x16')]();super[_0x3f22('0x16')]();}[_0x3f22('0x6')](){this[_0x3f22('0x25')]?this['_rearrangeCollapse']():this['_rearrangeExpand']();}['_handleNewCommentModel'](_0x589e5e){const _0x228333=new this[(_0x3f22('0x2'))][(_0x3f22('0x17'))](this[_0x3f22('0xd')],_0x589e5e,{'maxCommentCharsWhenCollapsed':this['_config']['maxCommentCharsWhenCollapsed'],'formatDateTime':this[_0x3f22('0x2')]['formatDateTime'],'editorConfig':this[_0x3f22('0x2')][_0x3f22('0x2b')]});_0x228333[_0x3f22('0x1b')]=_0x589e5e['id'],_0x228333[_0x3f22('0x18')](_0x3f22('0x1f'))['to'](this),_0x228333['delegate'](_0x3f22('0x9'))['to'](this),this['listenTo'](_0x228333,_0x3f22('0x13'),()=>this['_updateHasDirtyComment']()),this['commentViews'][_0x3f22('0x5')](_0x228333);}[_0x3f22('0x3')](_0x415f96){const _0x4775a4=this[_0x3f22('0x1e')][_0x3f22('0x28')](_0x415f96['id']);this['stopListening'](_0x4775a4),_0x4775a4[_0x3f22('0xc')]&&this['_updateHasDirtyComment'](),_0x4775a4[_0x3f22('0x16')]();}[_0x3f22('0x26')](){this[_0x3f22('0x15')]=Array['from'](this[_0x3f22('0x1e')])[_0x3f22('0x4')](_0x319f31=>_0x319f31['isEditMode']);}[_0x3f22('0x19')](){const _0x1fb8a4=function(_0x760e89){const _0x5478e4=new _0x47e4c9();for(const _0xaa00db of _0x760e89)_0x5478e4[_0x3f22('0x5')](_0xaa00db);return _0x5478e4;}(this['commentViews']),_0x5c6f78=this[_0x3f22('0x14')][_0x3f22('0x22')];for(let _0x27e7c8=0x1;_0x27e7c8<=_0x5c6f78;_0x27e7c8++)_0x1fb8a4[_0x3f22('0x28')](0x1);for(const _0x5deb3f of _0x1fb8a4)_0x5deb3f[_0x3f22('0x1d')]();_0x5c6f78>0x0&&_0x1fb8a4[_0x3f22('0x5')](this['_collapsedCommentsView'],0x1),Wt(_0xa99353(Array[_0x3f22('0x1')](this[_0x3f22('0xb')]),Array['from'](_0x1fb8a4)),this[_0x3f22('0xb')],_0x1fb8a4);}['_rearrangeExpand'](){Wt(_0xa99353(Array[_0x3f22('0x1')](this[_0x3f22('0xb')]),Array[_0x3f22('0x1')](this[_0x3f22('0x1e')])),this[_0x3f22('0xb')],this[_0x3f22('0x1e')]);for(const _0x45f4b0 of this[_0x3f22('0xb')])_0x45f4b0[_0x3f22('0x24')]();}}function Wt(_0x3544c8,_0x5899e6,_0x46b088){let _0x4a1bf1=0x0;for(const _0x59f3a4 of _0x3544c8)switch(_0x59f3a4){case _0x3f22('0x0'):_0x5899e6[_0x3f22('0x5')](_0x46b088[_0x3f22('0xa')](_0x4a1bf1),_0x4a1bf1),_0x4a1bf1++;break;case'delete':_0x5899e6[_0x3f22('0x28')](_0x4a1bf1);break;case _0x3f22('0xf'):_0x4a1bf1++;}}