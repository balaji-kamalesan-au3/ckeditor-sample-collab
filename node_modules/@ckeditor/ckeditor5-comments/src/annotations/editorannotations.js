/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3fcb=['change:isFocused','update','hasDomSelection','isReadOnly','getRanges','registerAnnotation','delete','EditorAnnotations','set','from','directChange','element','model','_dataCollectors','range','uiUpdate','containsRange','change:range','innerView','editor','add','map','remove','refresh','has','getByInnerView','plugins','blur','getOrderedSelectedAnnotations','cancel','_editorAnnotationsData','editing','annotation','isEqual','fire','focusTracker','init','get','_editorAnnotations','requires','collection','view','refreshSelectedViews','listenTo','document'];(function(_0x40f508,_0x3fcb7){const _0x1977ea=function(_0x40d250){while(--_0x40d250){_0x40f508['push'](_0x40f508['shift']());}};_0x1977ea(++_0x3fcb7);}(_0x3fcb,0x175));const _0x1977=function(_0x40f508,_0x3fcb7){_0x40f508=_0x40f508-0x0;let _0x1977ea=_0x3fcb[_0x40f508];return _0x1977ea;};import{Plugin as _0x3e1e73}from'ckeditor5/src/core';import{CKEditorError as _0x5ee804}from'ckeditor5/src/utils';import{debounce as _0x14a90a}from'lodash-es';import _0xebd0a4 from'./annotations';export default class k extends _0x3e1e73{static get[_0x1977('0x1a')](){return[_0xebd0a4];}static get['pluginName'](){return _0x1977('0x27');}constructor(_0x153003){super(_0x153003),this[_0x1977('0x0')]=new Set(),this[_0x1977('0x19')]=new Set();}[_0x1977('0x17')](){const _0x29f6c3=this[_0x1977('0x6')],_0xf73fbe=_0x29f6c3[_0x1977('0x2c')][_0x1977('0x1f')]['selection'],_0x2a12cf=_0x14a90a(()=>this[_0x1977('0x1d')](),0xa);_0xf73fbe['on'](_0x1977('0x4'),(_0x427c6c,_0xf9914f)=>{_0xf9914f[_0x1977('0x2a')]&&(_0x2a12cf[_0x1977('0x10')](),this[_0x1977('0x1d')]());}),this[_0x1977('0x1e')](_0x29f6c3[_0x1977('0x12')]['view'][_0x1977('0x1f')],_0x1977('0x20'),(_0x15e946,_0x176a67,_0x52a95f)=>{_0x52a95f&&_0x2a12cf();}),this[_0x1977('0x1e')](_0x29f6c3['ui']['focusTracker'],_0x1977('0x20'),(_0x109f08,_0x591925,_0x4ee32d)=>{_0x4ee32d||_0x29f6c3[_0x1977('0x23')]||this[_0x1977('0x15')](_0x1977('0xe'),{'isAnnotationTracked':_0xc298c7=>this[_0x1977('0x11')][_0x1977('0xb')](_0xc298c7[_0x1977('0x5')])});}),this[_0x1977('0x1e')](this[_0x1977('0x6')]['ui'],_0x1977('0x21'),()=>this['fire'](_0x1977('0x2')));}[_0x1977('0x25')](_0x487f32){if(this[_0x1977('0x19')][_0x1977('0xb')](_0x487f32))return;this[_0x1977('0x19')]['add'](_0x487f32[_0x1977('0x1c')]),this['editor']['ui'][_0x1977('0x16')][_0x1977('0x7')](_0x487f32[_0x1977('0x1c')][_0x1977('0x2b')]);const _0x298484=this['editor'][_0x1977('0xd')][_0x1977('0x18')](_0xebd0a4);this['listenTo'](_0x298484[_0x1977('0x1b')],'remove',(_0xa9b7f2,_0x4009d8)=>{this['editor']['ui'][_0x1977('0x16')][_0x1977('0x9')](_0x4009d8['view']['element']),this[_0x1977('0x19')][_0x1977('0x26')](_0x4009d8[_0x1977('0x1c')]);});}[_0x1977('0x22')](){return this[_0x1977('0x6')][_0x1977('0x12')][_0x1977('0x1c')][_0x1977('0x22')];}['addSourceCollector'](_0x1fe996){if('function'!=typeof _0x1fe996)throw new _0x5ee804('editorannotations-invalid-source-callback');this[_0x1977('0x0')][_0x1977('0x7')](_0x1fe996);}[_0x1977('0x1d')](){this[_0x1977('0x15')](_0x1977('0xa'));}[_0x1977('0xf')]({activeAnnotation:_0x305d62,annotations:_0x474368}){const _0x4eb5f5=[],_0x4ea2aa=this[_0x1977('0x6')][_0x1977('0x2c')]['document']['selection'],_0x4fe78c=Array[_0x1977('0x29')](_0x4ea2aa[_0x1977('0x24')]());for(const [_0x35f1cd,_0x21085b]of this['_editorAnnotationsData']){const _0x2befcb=_0x11ca91(_0x21085b),_0x46e00c=_0x474368[_0x1977('0xc')](_0x35f1cd);_0x2befcb&&_0x46e00c&&_0x4eb5f5['push']({'annotation':_0x46e00c,'range':_0x2befcb});}function _0x11ca91(_0xa1db23){for(const _0x12b812 of _0xa1db23)for(const _0x8d01d3 of _0x4fe78c)if(_0x12b812[_0x1977('0x3')](_0x8d01d3,!_0x4ea2aa['isCollapsed']))return _0x12b812;return null;}return _0x4eb5f5['sort']((_0x69cfd0,_0x3b8e5e)=>{const _0x28a3f0=_0x69cfd0[_0x1977('0x1')],_0x29f6bf=_0x3b8e5e[_0x1977('0x1')];if(!_0x28a3f0[_0x1977('0x14')](_0x29f6bf)){if(_0x28a3f0['containsRange'](_0x29f6bf,!0x0))return 0x1;if(_0x29f6bf[_0x1977('0x3')](_0x28a3f0,!0x0))return-0x1;}return _0x69cfd0[_0x1977('0x13')]==_0x305d62?-0x1:_0x3b8e5e[_0x1977('0x13')]==_0x305d62?0x1:0x0;})[_0x1977('0x8')](_0x541a08=>_0x541a08[_0x1977('0x13')]);}get[_0x1977('0x11')](){const _0x891dab=new Map();for(const _0x5a5d9d of Array['from'](this[_0x1977('0x0')]))for(const [_0x3335a2,_0x35eef0]of _0x5a5d9d())_0x891dab[_0x1977('0x28')](_0x3335a2,_0x35eef0);return _0x891dab;}}