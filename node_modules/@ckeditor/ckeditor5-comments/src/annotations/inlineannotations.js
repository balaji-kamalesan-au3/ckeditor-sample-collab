/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x365a=['setActiveAnnotation','editableElement','activeAnnotation','inlineannotations-detach-not-attached','detach','_balloon','change:height','attach','hasView','editor','delete','getOrderedSelectedAnnotations','getByView','_closeAnnotation','_selectedAnnotations','change:visibleView','_manuallyClosed','update','_removeAnnotationFromBalloon','isActive','updatePosition','showStack','set','isAttached','refresh','focus','has','view','focusTracker','requires','context','inline','InlineAnnotations','Esc','add','plugins','annotations','listenTo','blur','stopListening','switchTo','get','isFocused','register','mousedown','bind','_addAnnotationToBalloon','_setSelectedAnnotations','selection','inlineannotations-attach-already-attached','editing','getSelection','getRangeAt','includes','_addedAnnotations','_forceRefresh','document','remove','visibleView','hasActive','destroy'];(function(_0x288347,_0x365aa2){const _0x2d6422=function(_0x5f23f7){while(--_0x5f23f7){_0x288347['push'](_0x288347['shift']());}};_0x2d6422(++_0x365aa2);}(_0x365a,0x10e));const _0x2d64=function(_0x288347,_0x365aa2){_0x288347=_0x288347-0x0;let _0x2d6422=_0x365a[_0x288347];return _0x2d6422;};import{Plugin as _0x2efa8c}from'ckeditor5/src/core';import _0x520f74 from'./annotationsuis';import _0x14b07b from'./editorannotations';import{ContextualBalloon as _0x106781}from'ckeditor5/src/ui';import{MouseObserver as _0x3223b0}from'ckeditor5/src/engine';import{CKEditorError as _0x58a3d5}from'ckeditor5/src/utils';import'./../../theme/annotation-inline.css';export default class a extends _0x2efa8c{static get[_0x2d64('0x3')](){return[_0x14b07b,_0x106781,_0x520f74];}static get['pluginName'](){return _0x2d64('0x6');}constructor(_0x3349ac){super(_0x3349ac),_0x3349ac['editing'][_0x2d64('0x1')]['addObserver'](_0x3223b0),this[_0x2d64('0x3a')]=!0x1,this[_0x2d64('0x39')](_0x2d64('0x25'),null),this['annotations']=null,this[_0x2d64('0x33')]=new Set(),this[_0x2d64('0x28')]=_0x3349ac[_0x2d64('0x9')][_0x2d64('0xf')](_0x106781),this['_addedAnnotations']=new Set(),this[_0x2d64('0x31')]=[],this[_0x2d64('0x1d')]=!0x1;}['init'](){const _0x135c72=this['editor'][_0x2d64('0x9')]['get'](_0x520f74);_0x135c72[_0x2d64('0x4')]===this[_0x2d64('0x2c')]&&(_0x135c72[_0x2d64('0x11')]('inline',this),this[_0x2d64('0x2c')]['keystrokes'][_0x2d64('0x39')]('Esc',(_0x18a96d,_0x253829)=>{const _0xc236fa=this[_0x2d64('0x28')];if(this[_0x2d64('0x3a')]&&_0xc236fa[_0x2d64('0x20')]){const _0x358362=this['annotations'][_0x2d64('0x2f')](_0xc236fa[_0x2d64('0x20')]);this[_0x2d64('0x30')](_0x358362),_0x253829();}}));}['afterInit'](){const _0x3974c3=this['editor'][_0x2d64('0x9')]['get'](_0x520f74);_0x3974c3[_0x2d64('0x4')]===this[_0x2d64('0x2c')]&&(_0x3974c3[_0x2d64('0x21')]()||_0x3974c3[_0x2d64('0xe')](_0x2d64('0x5')));}[_0x2d64('0x23')](_0x2696b9){_0x2696b9!==this[_0x2d64('0x25')]&&(this[_0x2d64('0x25')]&&(this[_0x2d64('0x25')]['isActive']=!0x1),_0x2696b9&&this[_0x2d64('0x2c')]['ui'][_0x2d64('0x2')][_0x2d64('0x10')]&&(this[_0x2d64('0x14')](_0x2696b9,!0x0),_0x2696b9[_0x2d64('0x36')]=!0x0),_0x2696b9||this[_0x2d64('0x15')]([]),this[_0x2d64('0x25')]=_0x2696b9);}[_0x2d64('0x2a')](_0x490c37){this[_0x2d64('0xa')]=_0x490c37;const _0x50ddde=this[_0x2d64('0x2c')][_0x2d64('0x9')][_0x2d64('0xf')](_0x520f74),_0x35dcab=this['_balloon'];if(this[_0x2d64('0x3a')])throw new _0x58a3d5(_0x2d64('0x17'),this);if(_0x50ddde[_0x2d64('0x4')]!==this['editor'])throw new _0x58a3d5('inlineannotations-not-allowed-with-context',this);const _0x43d624=this[_0x2d64('0x2c')][_0x2d64('0x9')][_0x2d64('0xf')]('EditorAnnotations');this[_0x2d64('0xb')](_0x43d624,_0x2d64('0x3b'),function(){const _0x44c485=_0x43d624[_0x2d64('0x2e')]({'activeAnnotation':this[_0x2d64('0x25')],'annotations':this['annotations']});if(!this[_0x2d64('0x1d')]&&(_0x1bd761=_0x44c485,_0x47f969=this[_0x2d64('0x31')],_0x1bd761['length']===_0x47f969['length']&&_0x1bd761['every'](_0xe84f72=>_0x47f969[_0x2d64('0x1b')](_0xe84f72))))return;var _0x1bd761,_0x47f969;this[_0x2d64('0x1d')]=!0x1,this[_0x2d64('0x15')](_0x44c485),this[_0x2d64('0x23')](_0x44c485[0x0]||null);}[_0x2d64('0x13')](this)),this['listenTo'](_0x43d624,_0x2d64('0xc'),(_0x1d333a,{isAnnotationTracked:_0x124356})=>{this['activeAnnotation']&&_0x124356(this[_0x2d64('0x25')])&&(this[_0x2d64('0x15')]([]),this[_0x2d64('0x23')](null));}),this['listenTo'](this[_0x2d64('0x2c')]['ui'][_0x2d64('0x2')],'change:isFocused',(_0x1a434b,_0x496b02,_0x532185)=>{_0x532185||this[_0x2d64('0x23')](null);}),this[_0x2d64('0xb')](_0x490c37,_0x2d64('0x1f'),(_0x280430,_0x4a1ee2)=>{this[_0x2d64('0x35')](_0x4a1ee2),_0x4a1ee2===this[_0x2d64('0x25')]&&this[_0x2d64('0x23')](null);}),this[_0x2d64('0xb')](_0x35dcab,_0x2d64('0x32'),(_0x434a42,_0x3492cb,_0x3ec2af,_0xd0209e)=>{if(_0xd0209e&&this['stopListening'](_0xd0209e),!_0x3ec2af||!_0x490c37['getByView'](_0x3ec2af))return;const _0x609c0b=_0x490c37[_0x2d64('0x2f')](_0x3ec2af);this[_0x2d64('0xb')](_0x3ec2af,_0x2d64('0x29'),()=>{_0x35dcab['updatePosition']();}),this['listenTo'](_0x3ec2af,_0x2d64('0x7'),()=>{this[_0x2d64('0x30')](_0x609c0b),this['editor'][_0x2d64('0x18')][_0x2d64('0x1')][_0x2d64('0x3c')]();}),this[_0x2d64('0x25')]!==_0x609c0b&&this['setActiveAnnotation'](_0x609c0b);}),this[_0x2d64('0xb')](this[_0x2d64('0x2c')]['ui'],_0x2d64('0x34'),()=>{_0x35dcab[_0x2d64('0x20')]&&(_0x490c37[_0x2d64('0x2f')](_0x35dcab[_0x2d64('0x20')])&&_0x35dcab[_0x2d64('0x37')]());}),this[_0x2d64('0xb')](this['editor']['editing']['view'][_0x2d64('0x1e')],_0x2d64('0x12'),()=>{this['_forceRefresh']=!0x0,this['_manuallyClosed']['clear']();}),this['editor']['editing'][_0x2d64('0x1')][_0x2d64('0x1e')][_0x2d64('0x16')][_0x2d64('0x24')]&&this[_0x2d64('0x2c')][_0x2d64('0x18')][_0x2d64('0x1')][_0x2d64('0x3c')](),this[_0x2d64('0x3a')]=!0x0;}[_0x2d64('0x27')](){if(!this[_0x2d64('0x3a')])throw new _0x58a3d5(_0x2d64('0x26'),this);this['setActiveAnnotation'](null);for(const _0x3e615f of this[_0x2d64('0x1c')])this[_0x2d64('0x35')](_0x3e615f);this[_0x2d64('0xd')](),this[_0x2d64('0x3a')]=!0x1,this[_0x2d64('0xa')]=null;}[_0x2d64('0x22')](){this[_0x2d64('0x3a')]&&this['detach']();}[_0x2d64('0x15')](_0x4a79cf){for(const _0x5675d6 of this[_0x2d64('0x31')])_0x4a79cf[_0x2d64('0x1b')](_0x5675d6)||this['_manuallyClosed'][_0x2d64('0x2d')](_0x5675d6);for(const _0x349b84 of this[_0x2d64('0xa')])_0x4a79cf[_0x2d64('0x1b')](_0x349b84)||this[_0x2d64('0x35')](_0x349b84);if(this[_0x2d64('0x2c')]['ui'][_0x2d64('0x2')][_0x2d64('0x10')])for(const _0x337144 of _0x4a79cf)this[_0x2d64('0x14')](_0x337144);this['_selectedAnnotations']=_0x4a79cf;}['_addAnnotationToBalloon'](_0x190b31,_0x156004){this[_0x2d64('0x33')][_0x2d64('0x0')](_0x190b31)||(this['_addedAnnotations'][_0x2d64('0x0')](_0x190b31)||this[_0x2d64('0x28')][_0x2d64('0x2b')](_0x190b31[_0x2d64('0x1')])||(this['_addedAnnotations'][_0x2d64('0x8')](_0x190b31),this[_0x2d64('0x28')]['add']({'stackId':_0x190b31['view']['id'],'view':_0x190b31[_0x2d64('0x1')],'position':{'target':()=>_0x190b31['target']||_0x190b31['targetRect']||document[_0x2d64('0x19')]()[_0x2d64('0x1a')](0x0)}})),_0x156004&&this['_balloon'][_0x2d64('0x38')](_0x190b31[_0x2d64('0x1')]['id']));}[_0x2d64('0x35')](_0x4ea714){this[_0x2d64('0x1c')][_0x2d64('0x0')](_0x4ea714)&&this[_0x2d64('0x28')][_0x2d64('0x2b')](_0x4ea714['view'])&&(this[_0x2d64('0x1c')][_0x2d64('0x2d')](_0x4ea714),this[_0x2d64('0x28')][_0x2d64('0x1f')](_0x4ea714['view']));}[_0x2d64('0x30')](_0xad5fea){this[_0x2d64('0x33')]['add'](_0xad5fea),this['_removeAnnotationFromBalloon'](_0xad5fea);}}