/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x25b9=['listenTo','plugins','change:activeAnnotation','isActive','collection','_deactivateAllAnnotations','_visibleAnnotations','init','deactivate','attach','activeUIs','_addActiveAnnotation','size','set','length','hasActive','annotationsuis-activate-missing-ui','setActiveAnnotation','deactivateAll','switchTo','stopListening','destroy','annotationsuis-annotation-mismatch','get','_assertAnnotationDoesNotBelongToMultipleUIs','annotationsuis-register-already-registered','detach','context','delete','function','_uis','type','_uisData','filter','_setSelectedAnnotations','annotationsuis-register-invalid-interface','requires','_removeActiveAnnotation','register','remove','_activateAnnotation','has','from','add'];(function(_0xaaaa05,_0x25b95f){const _0x29013d=function(_0x1d7f63){while(--_0x1d7f63){_0xaaaa05['push'](_0xaaaa05['shift']());}};_0x29013d(++_0x25b95f);}(_0x25b9,0x90));const _0x2901=function(_0xaaaa05,_0x25b95f){_0xaaaa05=_0xaaaa05-0x0;let _0x29013d=_0x25b9[_0xaaaa05];return _0x29013d;};import{ContextPlugin as _0x5168a4}from'ckeditor5/src/core';import{CKEditorError as _0x3847f8}from'ckeditor5/src/utils';import _0x251115,{bindAnnotationCollections as _0x2855a1}from'./annotationcollection';import _0xbd634 from'./annotations';export default class I extends _0x5168a4{static get[_0x2901('0x18')](){return[_0xbd634];}static get['pluginName'](){return'AnnotationsUIs';}constructor(_0x559d7b){super(_0x559d7b),this[_0x2901('0x2a')]=new Set(),this[_0x2901('0x12')]=new Map(),this['_uisData']=new Map();}[_0x2901('0x27')](){const _0x567208=this[_0x2901('0xf')]['plugins'][_0x2901('0xb')](_0xbd634);this[_0x2901('0x20')](_0x567208,_0x2901('0x1c'),(_0x5b0fa9,_0x1e332c)=>{for(const _0x517425 of this['activeUIs']){const _0x49ddb6=this[_0x2901('0x12')][_0x2901('0xb')](_0x517425);(0x0,this[_0x2901('0x14')][_0x2901('0xb')](_0x517425)[_0x2901('0x15')])(_0x1e332c)&&_0x49ddb6[_0x2901('0x5')](_0x1e332c);}}),this['listenTo'](_0x567208,_0x2901('0x25'),()=>{for(const _0x2762cb of this[_0x2901('0x2a')]){this[_0x2901('0x12')]['get'](_0x2762cb)[_0x2901('0x5')](null);}}),this[_0x2901('0x20')](_0x567208[_0x2901('0x26')],_0x2901('0x1f'),(_0x9450f2,_0x537e8a)=>{this['_assertAnnotationDoesNotBelongToMultipleUIs'](_0x537e8a);});}[_0x2901('0x3')](){return this[_0x2901('0x2a')][_0x2901('0x0')]>0x0;}['isActive'](_0x18b678){return this['activeUIs']['has'](_0x18b678);}['activate'](_0x1c8970,_0x423227=()=>!0x0){const _0x3b7a3b=this[_0x2901('0xf')][_0x2901('0x21')][_0x2901('0xb')](_0xbd634);if(!this[_0x2901('0x12')][_0x2901('0x1d')](_0x1c8970))throw new _0x3847f8(_0x2901('0x4'),this,{'uiName':_0x1c8970});this[_0x2901('0x23')](_0x1c8970)&&this[_0x2901('0x28')](_0x1c8970),this['activeUIs']['add'](_0x1c8970);const _0x4eb114=new _0x251115(),_0x425810=_0x3b7a3b['_visibleAnnotations'];_0x2855a1({'source':_0x425810,'target':_0x4eb114,'filter':_0x423227}),this[_0x2901('0x14')][_0x2901('0x1')](_0x1c8970,{'collection':_0x4eb114,'filter':_0x423227});const _0x11ebf5=this['_uis']['get'](_0x1c8970);_0x11ebf5[_0x2901('0x29')](_0x4eb114),this[_0x2901('0x20')](_0x11ebf5,_0x2901('0x22'),(_0x7dd2fe,_0x2a1706,_0x5d1452,_0x56cb42)=>{_0x56cb42&&_0x3b7a3b[_0x2901('0x19')](_0x56cb42),_0x5d1452&&_0x3b7a3b[_0x2901('0x2b')](_0x5d1452);});}[_0x2901('0x28')](_0x4c8c52){this[_0x2901('0x2a')]['delete'](_0x4c8c52);const _0x3b518b=this[_0x2901('0x12')][_0x2901('0xb')](_0x4c8c52);_0x3b518b[_0x2901('0xe')](),this[_0x2901('0x8')](_0x3b518b),this[_0x2901('0x14')]['get'](_0x4c8c52)[_0x2901('0x24')][_0x2901('0x9')](),this[_0x2901('0x14')][_0x2901('0x10')](_0x4c8c52);}[_0x2901('0x7')](_0x33c331){const _0x4ad442=this['context'][_0x2901('0x21')][_0x2901('0xb')](_0xbd634),_0x1ad60c=Array[_0x2901('0x1e')](_0x4ad442['activeAnnotations'])[0x0]||null;this[_0x2901('0x6')](),this['activate'](_0x33c331);const _0x2cfab6=this[_0x2901('0x12')][_0x2901('0xb')](_0x33c331);_0x2cfab6[_0x2901('0x5')](_0x1ad60c),_0x2cfab6['_setSelectedAnnotations']&&_0x1ad60c&&_0x2cfab6[_0x2901('0x16')]([_0x1ad60c]);}[_0x2901('0x6')](){for(const _0x3af345 of this['activeUIs'])this[_0x2901('0x28')](_0x3af345);}[_0x2901('0x1a')](_0x286ea7,_0x38a849){if(this['_uis'][_0x2901('0x1d')](_0x286ea7))throw new _0x3847f8(_0x2901('0xd'));if(_0x2901('0x11')!=typeof _0x38a849[_0x2901('0x29')]||_0x2901('0x11')!=typeof _0x38a849[_0x2901('0xe')]||_0x2901('0x11')!=typeof _0x38a849[_0x2901('0x5')])throw new _0x3847f8(_0x2901('0x17'),null);this[_0x2901('0x12')][_0x2901('0x1')](_0x286ea7,_0x38a849);}['refilterAnnotations'](){const _0xa25295=this[_0x2901('0xf')][_0x2901('0x21')][_0x2901('0xb')](_0xbd634)[_0x2901('0x24')],_0x56ae59=new Map(),_0x1eaac3=Array[_0x2901('0x1e')](this['activeUIs']);for(const _0x25ecf7 of this[_0x2901('0x2a')]){const _0x4f92ff=this[_0x2901('0x14')][_0x2901('0xb')](_0x25ecf7)['collection'];for(const _0x1ae517 of _0x4f92ff)_0x56ae59['set'](_0x1ae517,_0x25ecf7);}for(const _0x3bd342 of _0xa25295){const _0x1426e9=_0x56ae59[_0x2901('0xb')](_0x3bd342);this[_0x2901('0xc')](_0x3bd342);const _0x4d81c7=_0x1eaac3['find'](_0x406ee5=>this[_0x2901('0x14')][_0x2901('0xb')](_0x406ee5)[_0x2901('0x15')](_0x3bd342));_0x1426e9!==_0x4d81c7&&(_0x1426e9&&this[_0x2901('0x14')][_0x2901('0xb')](_0x1426e9)[_0x2901('0x24')][_0x2901('0x1b')](_0x3bd342),_0x4d81c7&&this[_0x2901('0x14')][_0x2901('0xb')](_0x4d81c7)[_0x2901('0x24')]['add'](_0x3bd342));}}[_0x2901('0x9')](){this[_0x2901('0x6')](),super['destroy']();}[_0x2901('0xc')](_0x46366b){const _0xb2ddb5=[];for(const _0x1b6978 of this[_0x2901('0x2a')]){(0x0,this['_uisData'][_0x2901('0xb')](_0x1b6978)['filter'])(_0x46366b)&&_0xb2ddb5['push'](_0x1b6978);}if(_0xb2ddb5[_0x2901('0x2')]>0x1)throw new _0x3847f8(_0x2901('0xa'),null,{'matchedUIs':_0xb2ddb5,'annotationType':_0x46366b[_0x2901('0x13')]});}}