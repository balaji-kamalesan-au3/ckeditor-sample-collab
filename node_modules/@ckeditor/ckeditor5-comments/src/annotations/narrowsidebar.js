/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2bb9=['low','context','content','locale','annotations','mousedown','isDirty','_editorAnnotations','values','addAnnotation','narrowsidebar-attach-already-attached','northArrowSouthEast','keydown','ck-sidebar--narrow','contains','editors','southArrowNorth','_integrateWithEditorAnnotations','change:container','pluginName','_domEmitter','northArrowSouth','remove','_updateBalloonPosition','getSidebarItemView','add','isVisible','change:height','unpin','_showBalloon','has','activeAnnotation','blur','length','execute','set','_hideBalloon','Esc','delete','_attachToContainer','_manuallyClosedAnnotationViews','_detachListeners','balloonPanelView','removeEventListener','southArrowNorthWest','listenTo','resize','northArrowSouthWest','register','clear','hasDomSelection','preventDefault','southArrowNorthEast','number','_refreshPositioningDebounced','attach','high','_destroyEditorAnnotationsIntegration','focus','plugins','EditorAnnotations','_attachListeners','NarrowSidebar','_detachFromContainer','_selectedAnnotations','defaultPositions','view','_annotationToNarrowView','detach','_annotations','from','refresh','isAttached','set:container','addEventListener','element','cancel','off','get','narrowsidebar-detach-not-attached','_refreshPositioning','stopPropagation','first','keyCode','stop','narrowSidebar','destroy','bodyCollection','_setSelectedAnnotations','pin','setActiveAnnotation','stopListening','target','init','annotationType'];(function(_0x5afe90,_0x2bb980){const _0x36184d=function(_0xb72d64){while(--_0xb72d64){_0x5afe90['push'](_0x5afe90['shift']());}};_0x36184d(++_0x2bb980);}(_0x2bb9,0x7b));const _0x3618=function(_0x5afe90,_0x2bb980){_0x5afe90=_0x5afe90-0x0;let _0x36184d=_0x2bb9[_0x5afe90];return _0x36184d;};import{ContextPlugin as _0x423960}from'ckeditor5/src/core';import _0x2e66c9 from'./annotationsuis';import _0x402a53 from'./sidebar';import _0x315d6d from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x311c5d,BodyCollection as _0x5706cf}from'ckeditor5/src/ui';import{CKEditorError as _0x11d39a,DomEmitterMixin as _0x2c7250,keyCodes as _0x36289a,Collection as _0x549104}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{debounce as _0x5cf363}from'lodash-es';export default class s extends _0x423960{static get['requires'](){return[_0x402a53,_0x2e66c9];}static get[_0x3618('0x56')](){return _0x3618('0x22');}constructor(_0x2c506b){super(_0x2c506b),this[_0x3618('0x2c')]=!0x1,this[_0x3618('0xc')]=new Set(),this[_0x3618('0x57')]=Object['create'](_0x2c7250),this[_0x3618('0x27')]=new Map(),this[_0x3618('0x7')](_0x3618('0x3'),null),this[_0x3618('0x47')]=null,this[_0x3618('0x24')]=[],this[_0x3618('0x4a')]=new _0x549104(),this[_0x3618('0x1a')]=_0x5cf363(()=>{this[_0x3618('0x34')]();},0xfa,{'leading':!0x1});}[_0x3618('0x41')](){this[_0x3618('0x44')][_0x3618('0x1f')]['get'](_0x2e66c9)[_0x3618('0x14')](_0x3618('0x39'),this),this[_0x3618('0x3b')]=new _0x5706cf(this[_0x3618('0x44')][_0x3618('0x46')]),this[_0x3618('0xe')]=new _0x311c5d(this[_0x3618('0x44')][_0x3618('0x46')]),this['bodyCollection']['attachToDom'](),this[_0x3618('0x3b')][_0x3618('0x5c')](this[_0x3618('0xe')]);}[_0x3618('0x1b')](_0xa95c94){this['annotations']=_0xa95c94;const _0x585469=this['context'][_0x3618('0x1f')][_0x3618('0x32')](_0x402a53),_0x8ed3cb=this[_0x3618('0xe')];if(_0x585469[_0x3618('0x29')]=_0xa95c94,this[_0x3618('0x2c')])throw new _0x11d39a(_0x3618('0x4d'),this);this[_0x3618('0x2c')]=!0x0,this['listenTo'](_0x585469,_0x3618('0x2d'),()=>{this[_0x3618('0x28')](),this[_0x3618('0x11')](_0x585469,_0x3618('0x55'),_0x1ede2b=>{_0x1ede2b[_0x3618('0x31')](),this[_0x3618('0x1b')](_0xa95c94);});}),_0x585469[_0x3618('0xb')]({'viewClass':_0x3618('0x50'),'spaceBetweenItems':0x5});const _0x13395b=_0x1c68b5=>{const _0x52eb1f=new _0x315d6d(this[_0x3618('0x44')][_0x3618('0x46')]);_0x585469[_0x3618('0x4c')](_0x1c68b5,_0x52eb1f),this['_annotationToNarrowView'][_0x3618('0x7')](_0x1c68b5,_0x52eb1f),_0x52eb1f['bind'](_0x3618('0x49'),_0x3618('0x42'),_0x3618('0x19'))['to'](_0x1c68b5[_0x3618('0x26')],'isDirty','type',_0x3618('0x5')),_0x52eb1f['on'](_0x3618('0x6'),()=>{this[_0x3618('0xc')][_0x3618('0x15')](),_0x8ed3cb['content']['first']!==_0x1c68b5[_0x3618('0x26')]?(this[_0x3618('0x1')](_0x1c68b5),_0x1c68b5[_0x3618('0x26')]['element'][_0x3618('0x1e')](),this[_0x3618('0x3e')](_0x1c68b5)):this[_0x3618('0x3e')](null);});};for(const _0x3cd62c of _0xa95c94)_0x13395b(_0x3cd62c);this['listenTo'](_0xa95c94,_0x3618('0x5c'),(_0x4a05a3,_0x47ed0d)=>{_0x13395b(_0x47ed0d);}),this[_0x3618('0x11')](_0xa95c94,_0x3618('0x59'),(_0x1d4e4e,_0x548175,_0x261322)=>{this[_0x3618('0x27')][_0x3618('0x32')](_0x548175)['destroy'](),this[_0x3618('0x27')][_0x3618('0xa')](_0x548175),_0x585469['rearrange']({'removedAnnotation':_0x548175,'previousAnnotation':_0xa95c94[_0x3618('0x32')](_0x261322-0x1),'nextAnnotation':_0xa95c94[_0x3618('0x32')](_0x261322+0x1)}),_0x548175===this[_0x3618('0x3')]&&this[_0x3618('0x3e')](null);},{'priority':_0x3618('0x43')}),this[_0x3618('0x11')](_0xa95c94,'focus',(_0x592482,_0x562e02)=>{this[_0x3618('0x3e')](_0x562e02);}),this[_0x3618('0x11')](_0xa95c94,_0x3618('0x4'),()=>{this[_0x3618('0x3e')](null);}),this[_0x3618('0x57')][_0x3618('0x11')](document,_0x3618('0x4f'),(_0x26d50c,_0x3cbb12)=>{_0x3cbb12[_0x3618('0x37')]===_0x36289a['esc']&&_0x8ed3cb[_0x3618('0x5d')]&&(this['_manuallyClosedAnnotationViews']['add'](_0x8ed3cb['content'][_0x3618('0x36')]),this[_0x3618('0x8')](),_0x3cbb12[_0x3618('0x35')](),_0x3cbb12[_0x3618('0x17')]());}),this[_0x3618('0x57')][_0x3618('0x11')](document,_0x3618('0x48'),(_0x59de49,_0x5111c7)=>{const _0x105b4b=_0x5111c7[_0x3618('0x40')];_0x8ed3cb['isVisible']&&_0x8ed3cb['element']['contains'](_0x105b4b)||_0x585469[_0x3618('0x26')][_0x3618('0x2f')]['contains'](_0x105b4b)||_0x59de49['preventClosingBalloon']||(this[_0x3618('0xc')]['clear'](),this['_hideBalloon'](),this[_0x3618('0x3e')](null));});const _0x48c437=this['context'][_0x3618('0x52')]?this[_0x3618('0x44')][_0x3618('0x52')]:new _0x549104([this[_0x3618('0x44')]]);for(const _0x46a848 of _0x48c437)this[_0x3618('0x54')](_0x46a848);this['listenTo'](_0x48c437,_0x3618('0x5c'),(_0x2f88af,_0x342802)=>{this[_0x3618('0x11')](_0x342802,'ready',()=>{this[_0x3618('0x54')](_0x342802);});}),this[_0x3618('0x11')](_0x48c437,_0x3618('0x59'),(_0x32b9ed,_0x532cbc)=>{_0x532cbc['plugins'][_0x3618('0x2')](_0x3618('0x20'))&&this['_destroyEditorAnnotationsIntegration'](_0x532cbc[_0x3618('0x1f')][_0x3618('0x32')](_0x3618('0x20')));}),window[_0x3618('0x2e')](_0x3618('0x12'),this[_0x3618('0x1a')]),this[_0x3618('0x34')]();}['setActiveAnnotation'](_0x530fe0){if(_0x530fe0===this[_0x3618('0x3')])return;const _0x2e4a20=this[_0x3618('0x44')][_0x3618('0x1f')][_0x3618('0x32')]('Sidebar');if(_0x2e4a20[_0x3618('0x2b')]({'blurredAnnotation':this[_0x3618('0x3')],'activatedAnnotation':_0x530fe0,'disableAnimationOnActivatedAnnotation':!0x0}),_0x530fe0)_0x2e4a20[_0x3618('0x5b')](_0x530fe0)?this[_0x3618('0x1')](_0x530fe0):this[_0x3618('0x8')]();else this[_0x3618('0x8')]();this[_0x3618('0x3')]=_0x530fe0;}[_0x3618('0x28')](){if(!this[_0x3618('0x2c')])throw new _0x11d39a(_0x3618('0x33'),this);this[_0x3618('0x3e')](null);const _0x39398a=this['context'][_0x3618('0x1f')]['get']('Sidebar');this[_0x3618('0x8')](),Array[_0x3618('0x2a')](this[_0x3618('0x27')][_0x3618('0x4b')](),_0x8194eb=>_0x8194eb['destroy']()),this['_annotationToNarrowView'][_0x3618('0x15')](),_0x39398a[_0x3618('0x23')](this[_0x3618('0x47')]),this['stopListening'](),this[_0x3618('0x57')][_0x3618('0x3f')](),this[_0x3618('0x3f')](this[_0x3618('0x44')][_0x3618('0x52')]);for(const _0x541b92 of Array['from'](this[_0x3618('0x4a')]))this[_0x3618('0x1d')](_0x541b92);window[_0x3618('0xf')]('resize',this[_0x3618('0x1a')]),this['_refreshPositioningDebounced'][_0x3618('0x30')](),this[_0x3618('0x24')]=[],this[_0x3618('0x2c')]=!0x1,this[_0x3618('0x47')]=null;}[_0x3618('0x3a')](){this[_0x3618('0x2c')]&&this[_0x3618('0x28')](),this[_0x3618('0x3b')]['detachFromDom']();}['_integrateWithEditorAnnotations'](_0x16f2ce){const _0x55a23a=_0x16f2ce[_0x3618('0x1f')][_0x3618('0x32')](_0x3618('0x20')),_0x169fab=this[_0x3618('0x44')]['plugins'][_0x3618('0x32')](_0x402a53),_0x421d4a=this['annotations'],_0x11a8c9=this[_0x3618('0xe')],_0x1aee28=()=>{const _0x5db6ac=_0x55a23a['getOrderedSelectedAnnotations']({'activeAnnotation':this[_0x3618('0x3')],'annotations':this[_0x3618('0x47')]});this[_0x3618('0x3c')](_0x5db6ac),this['setActiveAnnotation'](_0x5db6ac[0x0]||null);};this[_0x3618('0x11')](_0x55a23a,_0x3618('0x2b'),_0x1aee28),this[_0x3618('0x11')](_0x55a23a,_0x3618('0x4'),(_0x172d7c,{isAnnotationTracked:_0x3586b7})=>{this[_0x3618('0x3')]&&_0x3586b7(this[_0x3618('0x3')])&&(this[_0x3618('0x3c')]([]),this['setActiveAnnotation'](null));}),this[_0x3618('0x11')](_0x55a23a,'uiUpdate',()=>{this[_0x3618('0x1a')]();}),this[_0x3618('0x11')](_0x421d4a,'blur',_0x43bc4c=>{_0x55a23a[_0x3618('0x16')]()&&_0x43bc4c[_0x3618('0x38')]();},{'priority':'high'}),this[_0x3618('0x57')][_0x3618('0x11')](document,'mousedown',(_0x4ae3f9,_0x4be687)=>{const _0x5df2d7=_0x4be687[_0x3618('0x40')];_0x11a8c9['isVisible']&&_0x11a8c9[_0x3618('0x2f')]['contains'](_0x5df2d7)||_0x169fab['view'][_0x3618('0x2f')][_0x3618('0x51')](_0x5df2d7)||this[_0x3618('0x3')]&&_0x55a23a['hasDomSelection']()&&(_0x1aee28(),_0x4ae3f9['preventClosingBalloon']=!0x0);},{'priority':_0x3618('0x1c')}),this[_0x3618('0x4a')][_0x3618('0x5c')](_0x55a23a);}['_destroyEditorAnnotationsIntegration'](_0x516283){_0x516283&&(this[_0x3618('0x3f')](_0x516283),this[_0x3618('0x4a')][_0x3618('0x59')](_0x516283));}[_0x3618('0x3c')](_0x413ff9){for(const _0x768951 of this['_selectedAnnotations'])_0x413ff9['includes'](_0x768951)||this[_0x3618('0xc')]['delete'](_0x768951[_0x3618('0x26')]);this[_0x3618('0x24')]=_0x413ff9;}[_0x3618('0x34')](){const _0x2b8fc3=this[_0x3618('0xe')];this['annotations']['refreshPositioning'](),_0x2b8fc3[_0x3618('0x5d')]&&this['_updateBalloonPosition']();}[_0x3618('0x1')](_0x4cc55e){if(this[_0x3618('0xc')][_0x3618('0x2')](_0x4cc55e[_0x3618('0x26')]))return;const _0x1a6e3f=this[_0x3618('0xe')]['content'][_0x3618('0x36')];_0x1a6e3f!==_0x4cc55e[_0x3618('0x26')]?(_0x1a6e3f&&this[_0x3618('0xd')](_0x1a6e3f),this[_0x3618('0x21')](_0x4cc55e['view']),this[_0x3618('0xe')][_0x3618('0x45')]['clear'](),this[_0x3618('0xe')][_0x3618('0x45')][_0x3618('0x5c')](_0x4cc55e['view']),this[_0x3618('0x5a')]()):this['_updateBalloonPosition']();}[_0x3618('0x5a')](){const _0x4bbb86=this[_0x3618('0xe')]['content'][_0x3618('0x36')],_0x26b471=this[_0x3618('0x47')]['getByView'](_0x4bbb86);if(!this['_annotationToNarrowView'][_0x3618('0x2')](_0x26b471))return;const _0x490fbe=this['_annotationToNarrowView'][_0x3618('0x32')](_0x26b471)[_0x3618('0x2f')],_0x5e459e=function(){const _0x1cf947=_0x311c5d[_0x3618('0x25')];return[_0x1cf947[_0x3618('0x18')],_0x1cf947[_0x3618('0x4e')],_0x1cf947[_0x3618('0x53')],_0x1cf947[_0x3618('0x58')],_0x1cf947[_0x3618('0x10')],_0x1cf947[_0x3618('0x13')]];}();this[_0x3618('0xe')][_0x3618('0x3d')]({'target':_0x490fbe,'positions':_0x5e459e});}[_0x3618('0x8')](){const _0x573a44=this[_0x3618('0xe')],_0x1dceac=_0x573a44[_0x3618('0x45')][_0x3618('0x36')];_0x1dceac&&(this['_detachListeners'](_0x1dceac),_0x573a44[_0x3618('0x0')](),_0x573a44[_0x3618('0x45')]['clear']());}[_0x3618('0x21')](_0x17dc80){this['listenTo'](_0x17dc80,_0x3618('0x5e'),()=>this['_updateBalloonPosition']()),this[_0x3618('0x11')](_0x17dc80,_0x3618('0x9'),(_0x39d0dd,_0x3f0c6d)=>{this['_manuallyClosedAnnotationViews']['add'](_0x17dc80),this[_0x3618('0x8')](),_0x3f0c6d();});}[_0x3618('0xd')](_0x32dcc2){this['stopListening'](_0x32dcc2);}}