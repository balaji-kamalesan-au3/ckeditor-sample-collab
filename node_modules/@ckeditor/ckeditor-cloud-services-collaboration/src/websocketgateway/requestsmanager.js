/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
'use strict';var __importDefault=this&&this['__importDefault']||function(_0x38ffde){return _0x38ffde&&_0x38ffde['__esModule']?_0x38ffde:{'default':_0x38ffde};};Object['defineProperty'](exports,'__esModule',{'value':!0x0});const ckeditorcloudserviceserror_1=__importDefault(require('../ckeditorcloudserviceserror'));class WebSocketRequest{constructor(_0x416b7b,_0x3ccdfa){this['_context']=_0x416b7b,this['_deferredPromise']=function(){let _0x5cdf4b,_0x183cdb;const _0x4a8245=new Promise((_0x103839,_0x660b8d)=>{_0x5cdf4b=_0x103839,_0x183cdb=_0x660b8d;});return{'resolve':_0x5cdf4b,'reject':_0x183cdb,'promise':_0x4a8245};}(),this['timeout']=setTimeout(()=>this['error'](new ckeditorcloudserviceserror_1['default']('Request\x20timeout.',this['_context'])),_0x3ccdfa);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x38a1d2){this['_deferredPromise']['resolve'](_0x38a1d2);}['error'](_0x61585d){this['_deferredPromise']['reject'](_0x61585d);}}exports['default']=class{constructor(_0x157612){this['_context']=_0x157612,this['_requests']=new Set();}async['send'](_0x3401db,_0x45d785=0x2710){const _0x2d0797=this['_createRequest'](_0x45d785);try{return _0x3401db(_0x2d0797),await _0x2d0797['promise'];}finally{this['_finishRequest'](_0x2d0797);}}['errorAll'](_0x2ccc88){for(const _0x1df78c of this['_requests'])_0x1df78c['error'](_0x2ccc88);}['_createRequest'](_0x3f16d0){const _0xca6579=new WebSocketRequest(this['_context'],_0x3f16d0);return this['_requests']['add'](_0xca6579),_0xca6579;}['_finishRequest'](_0xbd0fdb){this['_requests']['delete'](_0xbd0fdb),clearTimeout(_0xbd0fdb['timeout']);}};