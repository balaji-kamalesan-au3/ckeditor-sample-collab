/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3755=['from','isCollapsed','attachToDom','get','locale','presenceList.container','listenTo','balloonPanelView','presenceList.collapseAt','onClick','_handleUserAdd','items','showDropdown','pin','init','context','plugins','execute','lastConnectedUsers','presenceList','presencelist-missing-container','counterView','bindTo','render','usersCount','define','using','number','element','view','remove','hasTooltip','detachFromDom','presenceDropdownView','length','destroy','_allConnectedUsers','allConnectedUsers','bind','config','bodyCollection','requires','appendChild','presencelist-collapseat-invalid-format','hideDropdown','content','inlineListView','add'];(function(_0x453ff2,_0x3755b0){const _0x3acf77=function(_0x162be8){while(--_0x162be8){_0x453ff2['push'](_0x453ff2['shift']());}};_0x3acf77(++_0x3755b0);}(_0x3755,0x187));const _0x3acf=function(_0x453ff2,_0x3755b0){_0x453ff2=_0x453ff2-0x0;let _0x3acf77=_0x3755[_0x453ff2];return _0x3acf77;};import{ContextPlugin as _0x1eebda}from'ckeditor5/src/core';import{CKEditorError as _0x47efb7,Collection as _0x71ab69}from'ckeditor5/src/utils';import{clickOutsideHandler as _0x22c674,BodyCollection as _0x1b8915,BalloonPanelView as _0x1a8ff8}from'ckeditor5/src/ui';import{isElement as _0x42c560}from'lodash-es';import _0x31c10b from'../realtimecollaborativeediting/sessions';import _0x3a6703 from'./view/presencelistview';import _0x2cec72 from'./view/presencedropdownlistview';import _0x3b215e from'./view/presencedropdownlistitemview';import _0x2e2827 from'./view/presenceinlinelistitemview';export default class i extends _0x1eebda{constructor(_0x478619){super(_0x478619),_0x478619[_0x3acf('0x20')][_0x3acf('0x12')]('presenceList',{'collapseAt':0x6});const _0x49b5f4=_0x478619[_0x3acf('0x20')][_0x3acf('0x2c')](_0x3acf('0x1'));if(_0x3acf('0x14')!=typeof _0x49b5f4)throw new _0x47efb7(_0x3acf('0x24'),this);if(_0x49b5f4<0x1)throw new _0x47efb7(_0x3acf('0x24'),this);}static get[_0x3acf('0x22')](){return[_0x31c10b];}[_0x3acf('0x7')](){const _0x274089=this[_0x3acf('0x8')];this[_0x3acf('0x1d')]=_0x274089[_0x3acf('0x9')][_0x3acf('0x2c')](_0x31c10b)[_0x3acf('0x1e')],this['set'](_0x3acf('0x11'),0x0),this[_0x3acf('0xb')]=new _0x71ab69(),this['balloonPanelView']=new _0x1a8ff8(),this[_0x3acf('0x0')]['class']='ck\x20ck-presence-list__balloon',this[_0x3acf('0x16')]=this['_createView'](),this[_0x3acf('0x1a')]=void 0x0;for(const _0x420edf of this[_0x3acf('0x1d')])this[_0x3acf('0x3')](_0x420edf);this[_0x3acf('0x2f')](this[_0x3acf('0x1d')],'add',(_0x1a72c0,_0x5aae19)=>{this[_0x3acf('0x3')](_0x5aae19);}),this[_0x3acf('0x2f')](this[_0x3acf('0x1d')],_0x3acf('0x17'),(_0x252bef,_0x17fec1)=>{this['_handleUserRemove'](_0x17fec1);});}['_createView'](){const _0x2ebda9=this[_0x3acf('0x8')],_0xbf0787=new _0x3a6703(this[_0x3acf('0x8')][_0x3acf('0x2d')]),_0x1a0329=this['balloonPanelView'];if(!_0x42c560(_0x2ebda9['config'][_0x3acf('0x2c')](_0x3acf('0x2e'))))throw new _0x47efb7(_0x3acf('0xd'),this);return _0xbf0787[_0x3acf('0xe')][_0x3acf('0x1f')](_0x3acf('0x11'))['to'](this),_0xbf0787[_0x3acf('0x1f')](_0x3acf('0x2a'))['to'](this,_0x3acf('0x11'),_0x5bc837=>{const _0x2fd6e0=_0x5bc837>=_0x2ebda9[_0x3acf('0x20')]['get'](_0x3acf('0x1'));return _0xbf0787[_0x3acf('0xe')]['isHidden']=!(0x1==_0x5bc837||_0x2fd6e0),_0x2fd6e0||this[_0x3acf('0x25')](),_0x2fd6e0;}),_0xbf0787['inlineListView'][_0x3acf('0x4')]['bindTo'](this[_0x3acf('0xb')])['using'](_0x25d3a6=>{const _0x1ac132=_0x2ebda9[_0x3acf('0x20')]['get'](_0x3acf('0xc')),_0x38b81d=new _0x2e2827(_0x2ebda9[_0x3acf('0x2d')],_0x25d3a6,_0x1ac132[_0x3acf('0x2')]);return _0x38b81d[_0x3acf('0x1f')](_0x3acf('0x18'))['to'](_0xbf0787,_0x3acf('0x2a'),_0x555f34=>!_0x555f34),_0x1ac132[_0x3acf('0x2')]&&this[_0x3acf('0x2f')](_0x38b81d,_0x3acf('0xa'),()=>{this[_0x3acf('0x16')][_0x3acf('0x2a')]||_0x1ac132[_0x3acf('0x2')](_0x25d3a6,_0x38b81d[_0x3acf('0x15')]);}),_0x38b81d;}),this[_0x3acf('0x2f')](_0xbf0787['inlineListView'],_0x3acf('0xa'),()=>{this['presenceDropdownView']?this[_0x3acf('0x25')]():this['view'][_0x3acf('0x2a')]&&this[_0x3acf('0x5')]();}),_0xbf0787[_0x3acf('0x10')](),_0x1a0329[_0x3acf('0x10')](),_0x22c674({'emitter':_0xbf0787,'activator':()=>_0x1a0329['isVisible'],'contextElements':[_0x1a0329['element'],_0xbf0787[_0x3acf('0x27')][_0x3acf('0x15')]],'callback':()=>this[_0x3acf('0x25')]()}),_0x2ebda9[_0x3acf('0x20')][_0x3acf('0x2c')](_0x3acf('0x2e'))[_0x3acf('0x23')](_0xbf0787[_0x3acf('0x15')]),this[_0x3acf('0x21')]=new _0x1b8915(this['context'][_0x3acf('0x2d')]),this['bodyCollection'][_0x3acf('0x2b')](),this[_0x3acf('0x21')]['add'](_0x1a0329),_0xbf0787;}['_handleUserAdd'](_0x4abeca){this[_0x3acf('0x11')]++,0x5==this[_0x3acf('0xb')][_0x3acf('0x1b')]&&this[_0x3acf('0xb')][_0x3acf('0x17')](0x0),this[_0x3acf('0xb')]['add'](_0x4abeca);}['_handleUserRemove'](_0x448889){if(this[_0x3acf('0x11')]--,this['lastConnectedUsers']['get'](_0x448889['id'])&&(this[_0x3acf('0xb')][_0x3acf('0x17')](_0x448889['id']),this['lastConnectedUsers'][_0x3acf('0x1b')]<this[_0x3acf('0x11')]))for(const _0x3a1954 of Array[_0x3acf('0x29')](this[_0x3acf('0x1d')])['reverse']())if(!this[_0x3acf('0xb')][_0x3acf('0x2c')](_0x3a1954['id']))return void this[_0x3acf('0xb')]['add'](_0x3a1954,0x0);}[_0x3acf('0x5')](){if(this[_0x3acf('0x1a')])return;this['presenceDropdownView']=new _0x2cec72();const _0x16283c=this[_0x3acf('0x8')][_0x3acf('0x20')][_0x3acf('0x2c')](_0x3acf('0xc'));this[_0x3acf('0x1a')][_0x3acf('0x4')][_0x3acf('0xf')](this[_0x3acf('0x1d')])[_0x3acf('0x13')](_0x1ded4b=>{const _0x1c2085=new _0x3b215e(this['context'][_0x3acf('0x2d')],_0x1ded4b,!!_0x16283c[_0x3acf('0x2')]);return _0x16283c[_0x3acf('0x2')]&&this[_0x3acf('0x2f')](_0x1c2085,_0x3acf('0xa'),()=>{_0x16283c[_0x3acf('0x2')](_0x1ded4b,_0x1c2085['element']);}),_0x1c2085;}),this['balloonPanelView'][_0x3acf('0x26')][_0x3acf('0x28')](this[_0x3acf('0x1a')]),this[_0x3acf('0x0')][_0x3acf('0x6')]({'target':this[_0x3acf('0x16')]['inlineListView']['element']});}['hideDropdown'](){this['presenceDropdownView']&&(this[_0x3acf('0x0')]['unpin'](),this['balloonPanelView'][_0x3acf('0x26')][_0x3acf('0x17')](this[_0x3acf('0x1a')]),this[_0x3acf('0x1a')][_0x3acf('0x1c')](),this[_0x3acf('0x1a')]=void 0x0);}[_0x3acf('0x1c')](){super[_0x3acf('0x1c')](),this[_0x3acf('0x16')]&&this[_0x3acf('0x16')]['isRendered']&&this[_0x3acf('0x16')][_0x3acf('0x1c')](),this[_0x3acf('0x21')]&&this[_0x3acf('0x21')][_0x3acf('0x19')]();}}